name: Push FongMi APKs to Telegram

on:
  workflow_dispatch:

jobs:
  push-apks:
    runs-on: ubuntu-latest

    steps:
      - name: Download APKs
        run: |
          mkdir apks
          cd apks

          curl -L -o leanback-arm64_v8a.apk \
            https://raw.githubusercontent.com/FongMi/Release/main/apk/release/leanback-arm64_v8a.apk

          curl -L -o leanback-armeabi_v7a.apk \
            https://raw.githubusercontent.com/FongMi/Release/main/apk/release/leanback-armeabi_v7a.apk

          curl -L -o mobile-arm64_v8a.apk \
            https://raw.githubusercontent.com/FongMi/Release/main/apk/release/mobile-arm64_v8a.apk

          curl -L -o mobile-armeabi_v7a.apk \
            https://raw.githubusercontent.com/FongMi/Release/main/apk/release/mobile-armeabi_v7a.apk

          ls -lh

      - name: Upload APKs to Telegram
        env:
          BOT_API_URL: ${{ secrets.TELEGRAM_BOT_API_URL }}
          CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
        run: |
          cd apks

          for APK in *.apk; do
            echo "üöÄ ‰∏ä‰º† $APK"

            curl -X POST "$BOT_API_URL" \
              -F "chat_id=$CHAT_ID" \
              -F "document=@$APK" \
              -F "caption=üì¶ $APK"

            echo "‚úÖ $APK ‰∏ä‰º†ÂÆåÊàê"
          done
